# MySQL服务组件文档

> 本文档旨在为用户提供PaaS平台MySQL服务组件的全程指导。希望用户通过阅读该文档，能快速使用该组件的服务，降低学习成本，帮助用户轻松启用MySQL服务组件。

## MySQL组件介绍

### 组件概述

PaaS平台MySQL组件服务基于开源数据库 MySQL 提供高可用、便捷的MySQL集群服务，让用户能够轻松地设置、操作高可用关系型数据库。

**PaaS平台MySQL中间件服务主要技术定义如下：**

+ **MySQL版本：** PaaS平台MySQL中间件服务基于Percona5.7版本进行开发部署。Percona 完全兼容 MySQL 协议，且功能和性能上较 MySQL 有显著的提升。

+ **高可用(HA)：** PaaS平台MySQL中间件服务采用一主两从基于GTID复制实现数据库服务的高可用性，减少由于数据库服务宕机引起的服务中断时间。该方案架构简单稳定，消耗资源少，没有主机宕机后的选主问题。

### 组件优势

+ **小巧便捷**

MySQL组件在保证单节点故障的情况下,用最小的资源实现中从复制结构的稳定，避免投入大量成本建设基础设备。同时，MySQL组件服务免去了用户安装过程和环境搭建的繁琐，可专注于组件本身服务的使用，方便快捷。

+ **数据高可用性**
  
MySQL组件保证了在单节点故障的情况下，数据的不丢失。同时，提供宕机自动检测和故障自动迁移。减少故障对数据库服务的影响。

+ **专业的监控与告警**

监控平台提供7X24小时全面监控服务，提供预先设定的监控指标阈值，可随时掌控实例运行服务质量。

### 组件架构

![MySQL](pic\mysql-struc.png)

**架构特点：**

+ 基于GTID复制模式搭建一主两从的数据库集群架构。
+ 单点故障，不影响集群复制架构。
+ 基于replication-manager实现集群的HA，节点故障可自动切换到数据最新的节点。

### 组件存储引擎

MySQL组件的存储引擎决定了数据在计算机中的存储方式。MySQL组件默认支持InnoDB存储引擎。并不推荐使用MyiSAM或其他存储引擎。主要原因如下：

+ MyISAM 采用的是表级锁机制，而 InnoDB 是行级锁机制，通常情况下 InnoDB 具有更高的写入效率。
+ MyISAM 对数据完整性的保护存在缺陷，且这些缺陷会导致数据库数据的损坏甚至丢失。同时，数据结构的特性决定了MyISAM的数据恢复更加耗时耗力。
+ MyISAM 和其他存储引擎向 InnoDB 的迁移代价低，大多数应用仅需要改动建表的代码即可完成迁移。
+ MyISAM 的发展在向 InnoDB 转移，在最新的官方 MySQL 8.0 版本中，系统表均已采用 InnoDB。

## MySQL组件快速入门

### 初始化MySQL组件

暂不明确流程

### 数据库访问

> **前提条件**
>
> 访问MySQL服务组件前，应确认安装好相应客户端MySQL数据库连接的驱动，同时保证客户端到MySQL组件之间网络可通。暂未提供外网访问服务。

访问MySQL服务组件的方式如下：

| 方式|  说明|
|---------|---------|
| 命令行访问 |使用命令行通过终端对MySQL组件服务进行访问。<li>终端环境需对MySQL服务组件的网络可通。<li>终端已安装MySQL client，可执行MySQL访问的命令。| 
|第三方工具访问|对于日常的数据库管理和使用，可通过第三方工具对MySQL组件进行访问。<li>第三方工具所在环境需对MySQL服务组件的网络可通。 |

**命令行访问**

1. 登录进入终端系统，执行下面的命令安装MySQL客户端：

```
yum install mysql
```

提示Complete!后， MySQL 客户端安装完成。

![install](pic\install.png)

2. 安装完成后，执行如下命令登录到MySQL实例：

```
mysql -h hostname -u username -p password
```

- hostname：替换为目标MySQL组件实例的地址
- username：替换为使用的MySQL组件实例用户名，默认的用户名为root。

显示Enter password：后输入与用户名对应的password，如下图实例，若出现MySQL [(none)]>说明成功登入MySQL实例：
![install](pic\login.png)

3. 在`MySQL [(none)]>`提示符下可以发送SQL语句到要执行的MySQL服务实例，需了解更多命令行信息，请参考 [mysql Client Commands](https://dev.mysql.com/doc/refman/5.7/en/mysql-commands.html)。

下图中，演示了show databases;语句的执行效果：

![install](pic\image.png)

**第三方工具访问** 

使用第三方工具访问MySQL组件服务，可通过图形化界面进行交互，避免了命令行是的交互，更直观。常见的第三方工具包括Navicat，phpmyadmin，SQLyog，MySQL Workbench等。下面的示例中，讲演示Navicat对MySQL实例的连接访问。

1. 打开Navicat软件，在界面中找到"链接"按钮，点击后选择"MySQL":

![navi-1](pic\Navicat-1.png)

2. 在弹出的新界面中，输入连接名，这个连接名是为了方便记录是哪台服务器，可自行命名。输入主机，主机是mysql的服务器地址。输入端口：MySQL服务器端口。输入用户名和密码。

![navi-1](pic\navi-2.png)

3. 第二步的时候，如果担心自己输入的各项信息有误，可以使用左下角的“测试连接”，这个地方主要是测试数据库连接是否成功，如果不成功会提示相应的信息，然后，根据提示信息修改相应的信息。

![navi-1](pic\navi-3.png)

4. 在显示连接成功后，点击“保存”按钮。这时，操作界面会消失，同时，可以在主界面的左侧列表中多了一个“test”的菜单，这个菜单就是刚才添加的MySQL实例的链接。

![navi-1](pic\navi-5.png)

5. 双击左侧的“test”，就可以链接到MySQL组件服务了。连接后，可以针对不同的数据库进行各种操作。

![navi-1](pic\navi-4.png)

### 数据库管理


## MySQL组件操作指南

### 常用操作

### 数据库操作

### 参数配置

### 备份与回档

### 数据导入与导出
